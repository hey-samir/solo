import{r as x,f as c,j as e}from"./vendor-D1-M7YfK.js";import{C as g,a as v,L as j,B as h,b as y,A as C,p as A,c as S,d as f,P as D,i as k,D as R,e as d,f as b}from"./chart-9r43Zdqc.js";import{L as N,c as m}from"./main-BxwRSgSc.js";g.register(v,j,h,y,C,A,S,f,D,k);const T=()=>{const[s,t]=x.useState("metrics"),{data:l,isLoading:u}=c({queryKey:["user-stats"],queryFn:async()=>(await m.get("/user/me/stats")).data}),{data:a,isLoading:p}=c({queryKey:["stats-charts"],queryFn:async()=>(await m.get("/api/stats")).data});return u||p?e.jsx(N,{}):e.jsxs("div",{className:"container stats-container",children:[e.jsxs("ul",{className:"nav nav-pills stats-pills mb-4 sticky-top",role:"tablist",style:{top:0,zIndex:1020,backgroundColor:"#212529"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:`nav-link ${s==="metrics"?"active":""}`,onClick:()=>t("metrics"),type:"button",role:"tab",children:"Metrics"})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:`nav-link ${s==="trends"?"active":""}`,onClick:()=>t("trends"),type:"button",role:"tab",children:"Trends"})})]}),e.jsxs("div",{className:"tab-content",children:[s==="metrics"&&e.jsxs("div",{className:"row row-cols-1 row-cols-md-2 g-2 mb-4",children:[e.jsx(r,{value:l?.totalAscents,label:"Total Ascents"}),e.jsx(r,{value:l?.totalSends,label:"Total Sends"}),e.jsx(r,{value:l?.avgGrade,label:"Avg Grade"}),e.jsx(r,{value:l?.avgSentGrade,label:"Avg. Sent Grade"}),e.jsx(r,{value:l?.totalPoints,label:"Total Points"}),e.jsx(r,{value:l?.avgPointsPerClimb,label:"Avg Pts / Ascent"}),e.jsx(r,{value:`${l?.successRate}%`,label:"Send Rate"}),e.jsx(r,{value:`${l?.successRatePerSession}%`,label:"Session Send Rate"}),e.jsx(r,{value:l?.climbsPerSession,label:"Ascents / Session"}),e.jsx(r,{value:l?.avgAttemptsPerClimb,label:"Tries / Ascent"})]}),s==="trends"&&a&&e.jsxs("div",{children:[e.jsx(n,{title:"Route Mix",chart:e.jsx(R,{data:{labels:a.ascentsByDifficulty.labels,datasets:[{data:a.ascentsByDifficulty.data,backgroundColor:a.ascentsByDifficulty.labels.map(B)}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"}}}})}),e.jsx(n,{title:"Sends",chart:e.jsx(d,{data:{labels:a.sendsByDate.labels.map(o),datasets:[{label:"Sends",data:a.sendsByDate.sends,backgroundColor:"#7442d6",stack:"combined"},{label:"Attempts",data:a.sendsByDate.attempts,backgroundColor:"#6c757d",stack:"combined"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,stacked:!0},x:{stacked:!0}}}})}),e.jsx(n,{title:"Send Rate",chart:e.jsx(b,{data:{labels:a.metricsOverTime.labels.map(o),datasets:[{label:"Send Rate",data:a.metricsOverTime.metrics[0].data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}}}})}),e.jsx(n,{title:"Routes per Session",chart:e.jsx(b,{data:{labels:a.climbsPerSession.labels.map(o),datasets:[{label:"Routes",data:a.climbsPerSession.data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}),e.jsx(n,{title:"Send Rate by Color",chart:e.jsx(d,{data:{labels:a.sendRateByColor.labels,datasets:[{data:a.sendRateByColor.data,backgroundColor:"#7442d6"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:i=>`${i}%`}}},plugins:{legend:{display:!1}}}})})]})]})]})},r=({value:s,label:t})=>e.jsx("div",{className:"col-6 mb-2",children:e.jsxs("div",{className:"metric-card",style:{height:"100px"},children:[e.jsx("div",{className:"metric-value",children:s??0}),e.jsx("div",{className:"metric-label",children:t})]})}),n=({title:s,chart:t})=>e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header bg-transparent",children:e.jsx("h5",{className:"card-title mb-0",children:s})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{style:{height:"300px",width:"100%"},children:t})})]}),o=s=>{const t=new Date(s);return`${(t.getMonth()+1).toString().padStart(2,"0")}/${t.getDate().toString().padStart(2,"0")}`},B=s=>({"5.0":"#E9D8FD","5.1":"#D6BCFA","5.2":"#C084FC","5.3":"#A855F7","5.4":"#9333EA","5.5":"#7E22CE","5.6":"#6B21A8","5.7":"#581C87","5.8":"#4C1D95","5.9":"#3B0764","5.10a":"#350567","5.10b":"#2F035E","5.10c":"#290356","5.10d":"#23034E","5.11a":"#1D0345","5.11b":"#18033C","5.11c":"#130333","5.11d":"#0E032B","5.12a":"#090222","5.12b":"#08021D","5.12c":"#07021A","5.12d":"#060216","5.13a":"#050213","5.13b":"#040210","5.13c":"#03020D","5.13d":"#02020A","5.14a":"#010207","5.14b":"#010106","5.14c":"#010105","5.14d":"#010104","5.15a":"#010103","5.15b":"#010102","5.15c":"#010101","5.15d":"#000000"})[s]||"#7442d6";export{T as default};
