import{r as a,e as s,j as e,D as t,g as l,h as i}from"./vendor-react-CtadRSyQ.js";import{C as n,a as r,b as c,c as o,d,A as b,p as m,e as v,f as p,P as x,i as j}from"./vendor-chart-BLvGLuzR.js";import{L as u,c as g}from"./main-dRjaChud.js";import"./vendor-m8_k2utT.js";n.register(r,c,o,d,b,m,v,p,x,j);const h=()=>{const[n,r]=a.useState("metrics"),{data:c,isLoading:o}=s({queryKey:["user-stats"],queryFn:async()=>(await g.get("/user/me/stats")).data}),{data:d,isLoading:b}=s({queryKey:["stats-charts"],queryFn:async()=>(await g.get("/api/stats")).data});return o||b?e.jsx(u,{}):e.jsxs("div",{className:"container stats-container",children:[e.jsxs("ul",{className:"nav nav-pills stats-pills mb-4 sticky-top",role:"tablist",style:{top:0,zIndex:1020,backgroundColor:"#212529"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:"nav-link "+("metrics"===n?"active":""),onClick:()=>r("metrics"),type:"button",role:"tab",children:"Metrics"})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:"nav-link "+("trends"===n?"active":""),onClick:()=>r("trends"),type:"button",role:"tab",children:"Trends"})})]}),e.jsxs("div",{className:"tab-content",children:["metrics"===n&&e.jsxs("div",{className:"row row-cols-1 row-cols-md-2 g-2 mb-4",children:[e.jsx(y,{value:c?.totalAscents,label:"Total Ascents"}),e.jsx(y,{value:c?.totalSends,label:"Total Sends"}),e.jsx(y,{value:c?.avgGrade,label:"Avg Grade"}),e.jsx(y,{value:c?.avgSentGrade,label:"Avg. Sent Grade"}),e.jsx(y,{value:c?.totalPoints,label:"Total Points"}),e.jsx(y,{value:c?.avgPointsPerClimb,label:"Avg Pts / Ascent"}),e.jsx(y,{value:`${c?.successRate}%`,label:"Send Rate"}),e.jsx(y,{value:`${c?.successRatePerSession}%`,label:"Session Send Rate"}),e.jsx(y,{value:c?.climbsPerSession,label:"Ascents / Session"}),e.jsx(y,{value:c?.avgAttemptsPerClimb,label:"Tries / Ascent"})]}),"trends"===n&&d&&e.jsxs("div",{children:[e.jsx(A,{title:"Route Mix",chart:e.jsx(t,{data:{labels:d.ascentsByDifficulty.labels,datasets:[{data:d.ascentsByDifficulty.data,backgroundColor:d.ascentsByDifficulty.labels.map(S)}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"}}}})}),e.jsx(A,{title:"Sends",chart:e.jsx(l,{data:{labels:d.sendsByDate.labels.map(C),datasets:[{label:"Sends",data:d.sendsByDate.sends,backgroundColor:"#7442d6",stack:"combined"},{label:"Attempts",data:d.sendsByDate.attempts,backgroundColor:"#6c757d",stack:"combined"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,stacked:!0},x:{stacked:!0}}}})}),e.jsx(A,{title:"Send Rate",chart:e.jsx(i,{data:{labels:d.metricsOverTime.labels.map(C),datasets:[{label:"Send Rate",data:d.metricsOverTime.metrics[0].data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}}}})}),e.jsx(A,{title:"Routes per Session",chart:e.jsx(i,{data:{labels:d.climbsPerSession.labels.map(C),datasets:[{label:"Routes",data:d.climbsPerSession.data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}),e.jsx(A,{title:"Send Rate by Color",chart:e.jsx(l,{data:{labels:d.sendRateByColor.labels,datasets:[{data:d.sendRateByColor.data,backgroundColor:"#7442d6"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:a=>`${a}%`}}},plugins:{legend:{display:!1}}}})})]})]})]})},y=({value:a,label:s})=>e.jsx("div",{className:"col-6 mb-2",children:e.jsxs("div",{className:"metric-card",style:{height:"100px"},children:[e.jsx("div",{className:"metric-value",children:a??0}),e.jsx("div",{className:"metric-label",children:s})]})}),A=({title:a,chart:s})=>e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header bg-transparent",children:e.jsx("h5",{className:"card-title mb-0",children:a})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{style:{height:"300px",width:"100%"},children:s})})]}),C=a=>{const s=new Date(a);return`${(s.getMonth()+1).toString().padStart(2,"0")}/${s.getDate().toString().padStart(2,"0")}`},S=a=>({"5.0":"#E9D8FD",5.1:"#D6BCFA",5.2:"#C084FC",5.3:"#A855F7",5.4:"#9333EA",5.5:"#7E22CE",5.6:"#6B21A8",5.7:"#581C87",5.8:"#4C1D95",5.9:"#3B0764","5.10a":"#350567","5.10b":"#2F035E","5.10c":"#290356","5.10d":"#23034E","5.11a":"#1D0345","5.11b":"#18033C","5.11c":"#130333","5.11d":"#0E032B","5.12a":"#090222","5.12b":"#08021D","5.12c":"#07021A","5.12d":"#060216","5.13a":"#050213","5.13b":"#040210","5.13c":"#03020D","5.13d":"#02020A","5.14a":"#010207","5.14b":"#010106","5.14c":"#010105","5.14d":"#010104","5.15a":"#010103","5.15b":"#010102","5.15c":"#010101","5.15d":"#000000"}[a]||"#7442d6");export{h as default};
