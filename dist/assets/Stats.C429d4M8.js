import{r as a,f as s,j as e}from"./vendor.BYKJsIdm.js";import{C as t,a as l,L as i,B as n,b as r,A as c,p as d,c as o,d as b,P as m,i as x,D as v,e as p,f as u}from"./chart.cU8X5f3g.js";import{L as j,c as g}from"./index.IlIzE3wi.js";t.register(l,i,n,r,c,d,o,b,m,x);const h=()=>{const[t,l]=a.useState("metrics"),{data:i,isLoading:n}=s({queryKey:["user-stats"],queryFn:async()=>(await g.get("/user/me/stats")).data}),{data:r,isLoading:c}=s({queryKey:["stats-charts"],queryFn:async()=>(await g.get("/api/stats")).data});return n||c?e.jsx(j,{}):e.jsxs("div",{className:"container stats-container",children:[e.jsxs("ul",{className:"nav nav-pills stats-pills mb-4 sticky-top",role:"tablist",style:{top:0,zIndex:1020,backgroundColor:"#212529"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:"nav-link "+("metrics"===t?"active":""),onClick:()=>l("metrics"),type:"button",role:"tab",children:"Metrics"})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsx("button",{className:"nav-link "+("trends"===t?"active":""),onClick:()=>l("trends"),type:"button",role:"tab",children:"Trends"})})]}),e.jsxs("div",{className:"tab-content",children:["metrics"===t&&e.jsxs("div",{className:"row row-cols-1 row-cols-md-2 g-2 mb-4",children:[e.jsx(y,{value:i?.totalAscents,label:"Total Ascents"}),e.jsx(y,{value:i?.totalSends,label:"Total Sends"}),e.jsx(y,{value:i?.avgGrade,label:"Avg Grade"}),e.jsx(y,{value:i?.avgSentGrade,label:"Avg. Sent Grade"}),e.jsx(y,{value:i?.totalPoints,label:"Total Points"}),e.jsx(y,{value:i?.avgPointsPerClimb,label:"Avg Pts / Ascent"}),e.jsx(y,{value:`${i?.successRate}%`,label:"Send Rate"}),e.jsx(y,{value:`${i?.successRatePerSession}%`,label:"Session Send Rate"}),e.jsx(y,{value:i?.climbsPerSession,label:"Ascents / Session"}),e.jsx(y,{value:i?.avgAttemptsPerClimb,label:"Tries / Ascent"})]}),"trends"===t&&r&&e.jsxs("div",{children:[e.jsx(A,{title:"Route Mix",chart:e.jsx(v,{data:{labels:r.ascentsByDifficulty.labels,datasets:[{data:r.ascentsByDifficulty.data,backgroundColor:r.ascentsByDifficulty.labels.map(S)}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"}}}})}),e.jsx(A,{title:"Sends",chart:e.jsx(p,{data:{labels:r.sendsByDate.labels.map(C),datasets:[{label:"Sends",data:r.sendsByDate.sends,backgroundColor:"#7442d6",stack:"combined"},{label:"Attempts",data:r.sendsByDate.attempts,backgroundColor:"#6c757d",stack:"combined"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,stacked:!0},x:{stacked:!0}}}})}),e.jsx(A,{title:"Send Rate",chart:e.jsx(u,{data:{labels:r.metricsOverTime.labels.map(C),datasets:[{label:"Send Rate",data:r.metricsOverTime.metrics[0].data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}}}})}),e.jsx(A,{title:"Routes per Session",chart:e.jsx(u,{data:{labels:r.climbsPerSession.labels.map(C),datasets:[{label:"Routes",data:r.climbsPerSession.data,borderColor:"#7442d6",backgroundColor:"rgba(116, 66, 214, 0.2)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}}}})}),e.jsx(A,{title:"Send Rate by Color",chart:e.jsx(p,{data:{labels:r.sendRateByColor.labels,datasets:[{data:r.sendRateByColor.data,backgroundColor:"#7442d6"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:a=>`${a}%`}}},plugins:{legend:{display:!1}}}})})]})]})]})},y=({value:a,label:s})=>e.jsx("div",{className:"col-6 mb-2",children:e.jsxs("div",{className:"metric-card",style:{height:"100px"},children:[e.jsx("div",{className:"metric-value",children:a??0}),e.jsx("div",{className:"metric-label",children:s})]})}),A=({title:a,chart:s})=>e.jsxs("div",{className:"card mb-4",children:[e.jsx("div",{className:"card-header bg-transparent",children:e.jsx("h5",{className:"card-title mb-0",children:a})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{style:{height:"300px",width:"100%"},children:s})})]}),C=a=>{const s=new Date(a);return`${(s.getMonth()+1).toString().padStart(2,"0")}/${s.getDate().toString().padStart(2,"0")}`},S=a=>({"5.0":"#E9D8FD",5.1:"#D6BCFA",5.2:"#C084FC",5.3:"#A855F7",5.4:"#9333EA",5.5:"#7E22CE",5.6:"#6B21A8",5.7:"#581C87",5.8:"#4C1D95",5.9:"#3B0764","5.10a":"#350567","5.10b":"#2F035E","5.10c":"#290356","5.10d":"#23034E","5.11a":"#1D0345","5.11b":"#18033C","5.11c":"#130333","5.11d":"#0E032B","5.12a":"#090222","5.12b":"#08021D","5.12c":"#07021A","5.12d":"#060216","5.13a":"#050213","5.13b":"#040210","5.13c":"#03020D","5.13d":"#02020A","5.14a":"#010207","5.14b":"#010106","5.14c":"#010105","5.14d":"#010104","5.15a":"#010103","5.15b":"#010102","5.15c":"#010101","5.15d":"#000000"}[a]||"#7442d6");export{h as default};
